import{u as C,T as G,a as i,V as x,v as l,s as K,e as de,b as U,c as J,N as _,d as Q,f as X,m as Y,l as ze,g as De,h as be,p as Pe,i as Fe,j as Me,P as Ce,W as Ge,S as We,O as Be,M as He,k as Ie,R as B,F as Ne,n as se,o as ue,C as H,H as Ae,L as E,q as Le,r as Ve,t as ke,w as je,x as qe,y as Ee,z as Oe,A as Ue,B as Ke}from"./PointerManager-BwHd8Ss5.js";/* empty css              */const Je=()=>{const t=C(new G),a=C(new G),u=i(new x),o=i(new x),e=i(new x),n=i(new x),r=i(0),m=i(0),T=i(0),D=l(K.xy).mul(o),c=l(D.x,D.y.oneMinus()),A=Se=>{const ye=l(Se).mul(n),he=Y(n.x.div(e.x),n.y.div(e.y)),ie=l(e).mul(he),Te=l(n).sub(ie).mul(.5),Re=l(ye).sub(Te).div(ie);return a.sample(Re).rgb},L=t.sample(c).r,V=t.sample(c.sub(l(u.x,0))).r,k=t.sample(c.add(l(u.x,0))).r,j=t.sample(c.sub(l(0,u.y))).r,P=t.sample(c.add(l(0,u.y))).r,fe=l(k.sub(V).mul(.5),P.sub(j).mul(.5)),we=c.add(fe.mul(r)),pe=A(we),re=de(m.mul(L).mul(-1)),ve=U(1).mul(T.mul(U(1).sub(re))),xe=pe.mul(re).add(ve),ge=J(xe,1),q=new _;return q.vertexNode=Q(),q.fragmentNode=ge,X(q,{uDye:t,uBackground:a,uDyeTexel:u,uScreenTexel:o,uBGSizePx:e,uScreenSizePx:n,uRefractAmp:r,uDensityK:m,uSmokeGain:T})},_e=()=>{const t=C(new G),a=C(new G),u=i(new x),o=i(new x),e=i(0),n=i(0),r=i(0),m=l(K.xy).mul(o),T=t.sample(m).toVar(),D=e.mul(ze(T.xy)),c=De(.02,.1,D),A=m.sub(T.xy.mul(n).mul(e).mul(u).mul(c)),L=be(A,o),V=a.sample(L).rgb,k=Pe(.5,e.div(Y(r,1e-6))),j=J(V.mul(k),1),P=new _;return P.vertexNode=Q(),P.fragmentNode=j,X(P,{uData:t,uImage:a,uTexelSize:u,uTextureSize:o,uDeltaT:e,uDyeAdvectScale:n,uHalfLife:r})},Qe=()=>{const t=C(new G),a=i(new x),u=i(new x),o=i(0),e=i(0),n=l(K.xy).mul(a),r=t.sample(n).rgb.toVar(),m=n.sub(u).div(Y(l(o).mul(a),l(1e-6))),T=Fe(r.add(U(1).mul(e).mul(de(Me(m,m).mul(-1)))),0,1),D=J(T,1),c=new _;return c.vertexNode=Q(),c.fragmentNode=D,X(c,{uImage:t,uTextureSize:a,uForceCenter:u,uForceRadius:o,uInjectGain:e})},p={pixelRatio:.5,solverIteration:5,forceRadius:50,forceCoefficient:1e3,dissipation:.998};let le=0;const f=new Ce;let s,I,Z,W,b=Math.round(window.innerWidth*window.devicePixelRatio*p.pixelRatio),z=Math.round(window.innerHeight*window.devicePixelRatio*p.pixelRatio),w=new x,F=new x,d,v,R,g,y,$,ee,te,ae,ne,oe,N,h;await Xe();me(performance.now());async function Xe(){s=new Ge({antialias:!1,forceWebGL:!1}),await s.init(),s.setPixelRatio(window.devicePixelRatio),s.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(s.domElement),I=new We,Z=new Be(-1,1,1,-1,0,1),W=new He(new Ie(2,2)),I.add(W);const t={wrapS:H,wrapT:H,minFilter:ue,magFilter:ue,format:se,type:Ne,depthBuffer:!1,stencilBuffer:!1};d=new B(b,z,t),v=new B(b,z,t),ce(d),ce(v);const a={wrapS:H,wrapT:H,minFilter:E,magFilter:E,format:se,type:Ae,depthBuffer:!1,stencilBuffer:!1};g=new B(window.innerWidth,window.innerHeight,a),y=new B(window.innerWidth,window.innerHeight,a),$=Le(),ee=Ve(),te=ke(),ae=je(),ne=qe(),oe=Qe(),N=_e(),h=Je(),await Ye(h),R=new Ee().load("texture_demo1.jpg",()=>{h.uniforms.uBGSizePx.value.set(R.width,R.height),O()}),R.minFilter=Oe,R.magFilter=E,R.colorSpace=Ue,h.uniforms.uBackground.value=R,window.addEventListener("resize",O),f.init(s.domElement),f.addEventListener("firstInteraction",()=>{document.querySelector("#overlay-hint").style.display="none"}),O()}function O(){s.setPixelRatio(window.devicePixelRatio),s.setSize(window.innerWidth,window.innerHeight);const t=window.innerWidth*window.devicePixelRatio,a=window.innerHeight*window.devicePixelRatio;b=Math.round(t*p.pixelRatio),z=Math.round(a*p.pixelRatio),d.setSize(b,z),v.setSize(b,z),g.setSize(t,a),y.setSize(t,a),f.resizeTarget(p.pixelRatio,s.backend.coordinateSystem===Ke?z:0),w.set(1/b,1/z),F.set(1/t,1/a),$.uniforms.uTexelSize.value.copy(w),ee.uniforms.uTexelSize.value.copy(w),te.uniforms.uTexelSize.value.copy(w),ae.uniforms.uTexelSize.value.copy(w),ne.uniforms.uTexelSize.value.copy(w),oe.uniforms.uTextureSize.value.copy(F),N.uniforms.uTexelSize.value.copy(w),N.uniforms.uTextureSize.value.copy(F),h.uniforms.uDyeTexel.value.copy(F),h.uniforms.uScreenTexel.value.copy(F),h.uniforms.uScreenSizePx.value.set(t,a)}function me(t){const a=(t-le)/1e3;if(f.isPointerDown){const o=$,e=o.uniforms,n=f.pointer.clone().sub(f.prevPointer).multiply(w).multiplyScalar(p.forceCoefficient).multiplyScalar(window.devicePixelRatio);e.uData.value=d.texture,e.uForceCenter.value.copy(f.pointer.clone().multiply(w)),e.uForceDeltaV.value.copy(n),e.uForceRadius.value=p.forceRadius,S(o,v),M()}const u=Math.min(Math.max(Math.floor(a*240),1),8);for(let o=0;o<u;o++){const e=a/u;{const n=ee,r=n.uniforms;r.uData.value=d.texture,r.uDeltaT.value=e,r.uDissipation.value=p.dissipation,S(n,v),M()}{const n=te,r=n.uniforms;r.uData.value=d.texture,S(n,v),M()}for(let n=0;n<p.solverIteration;n++){const r=ae,m=r.uniforms;m.uData.value=d.texture,S(r,v),M()}{const n=ne,r=n.uniforms;r.uData.value=d.texture,S(n,v),M()}}if(f.isPointerDown){const o=oe,e=o.uniforms;e.uImage.value=g.texture,e.uForceCenter.value.copy(f.pointer.clone().multiply(w)),e.uForceRadius.value=p.forceRadius*window.devicePixelRatio,e.uInjectGain.value=50,S(o,y),[g,y]=[y,g]}{const o=N,e=o.uniforms;e.uImage.value=g.texture,e.uData.value=d.texture,e.uDeltaT.value=a,e.uDyeAdvectScale.value=15,e.uHalfLife.value=.3,S(o,y),[g,y]=[y,g]}{const o=h,e=o.uniforms;e.uDye.value=g.texture,e.uRefractAmp.value=.8,e.uDensityK.value=.2,e.uSmokeGain.value=.9,S(o,null)}f.updatePreviousPointer(),le=t,requestAnimationFrame(me)}function ce(t){s.setRenderTarget(t),s.clearColor(),s.setRenderTarget(null)}function S(t,a){W.material=t,s.setRenderTarget(a),s.render(I,Z),s.setRenderTarget(null)}function M(){[d,v]=[v,d]}async function Ye(t){W.material=t;const a=await s.debug.getShaderAsync(I,Z,W);console.log(a.vertexShader),console.log(a.fragmentShader)}
