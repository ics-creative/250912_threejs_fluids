import{u as C,T as b,a as T,V as h,v as M,s as G,N as L,e as A,g as O,r as re,d as $,w as ie,P as oe,W as se,S as ue,O as le,M as ce,h as de,R as F,F as me,i as _,j as K,C as P,H as we,y as q,k as fe,m as ge,n as he,o as pe,p as ve,x as xe,L as Se,z as Te,q as ee}from"./PointerManager-D3T1aSYE.js";/* empty css              */const ye=()=>{const t=C(new b),e=T(new h),s=T(new h(1,1)),i=M(G.xy).mul(e),r=M(i.x,i.y.oneMinus()),n=t.sample(r),a=new L;return a.vertexNode=A(),a.fragmentNode=n,O(a,{uImage:t,uTextureSize:e,uImageScale:s})},Re=()=>{const t=C(new b),e=C(new b),s=T(new h),i=T(new h),r=T(0),n=M(G.xy).mul(i),a=t.sample(n).toVar(),p=n.sub(a.xy.mul(r).mul(s).mul(3)),N=re(p,i),H=e.sample(N).rgb,E=$(H,1),R=new L;return R.vertexNode=A(),R.fragmentNode=E,O(R,{uData:t,uImage:e,uTexelSize:s,uTextureSize:i,uDeltaT:r})},ze=t=>{const e=C(new b),s=T(new h),i=T(new h),r=M(G.xy).mul(s),a=(t?r:M(r.x,r.y.oneMinus())).sub(.5).mul(i).add(.5),p=a.x.greaterThanEqual(0).and(a.x.lessThanEqual(1)),N=a.y.greaterThanEqual(0).and(a.y.lessThanEqual(1)),H=p.and(N),E=e.sample(a),R=$(0,0,0,1),ne=ie(H,E,R),V=new L;return V.vertexNode=A(),V.fragmentNode=ne,O(V,{uImage:e,uTextureSize:s,uImageScale:i})},d={pixelRatio:.5,solverIteration:5,forceRadius:20,forceCoefficient:1e3,dissipation:.996};let Q=0;const f=new oe;let o,D,U,I,y=Math.round(window.innerWidth*window.devicePixelRatio*d.pixelRatio),v=Math.round(window.innerHeight*window.devicePixelRatio*d.pixelRatio),c=new h,u,l,x,S,m,k,j,J,X,Y,W,g;await Me();ae(performance.now());async function Me(){o=new se({antialias:!1,forceWebGL:!1}),await o.init(),o.setPixelRatio(window.devicePixelRatio),o.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(o.domElement),D=new ue,U=new le(-1,1,1,-1,0,1),I=new ce(new de(2,2)),D.add(I);const t={wrapS:P,wrapT:P,minFilter:K,magFilter:K,format:_,type:me,depthBuffer:!1,stencilBuffer:!1};u=new F(y,v,t),l=new F(y,v,t),Z(u),Z(l);const e={wrapS:P,wrapT:P,minFilter:q,magFilter:q,format:_,type:we,depthBuffer:!1,stencilBuffer:!1};S=new F(window.innerWidth,window.innerHeight,e),m=new F(window.innerWidth,window.innerHeight,e),k=fe(),j=ge(),J=he(),X=pe(),Y=ve(),W=Re(),g=ye(),await Fe(g),x=new xe().load("texture_demo3.jpg",()=>{B()}),x.minFilter=Se,x.magFilter=q,x.colorSpace=Te,window.addEventListener("resize",B),f.init(o.domElement),f.addEventListener("firstInteraction",()=>{document.querySelector("#overlay-hint").style.display="none"}),B()}function B(){o.setPixelRatio(window.devicePixelRatio),o.setSize(window.innerWidth,window.innerHeight);const t=window.innerWidth*window.devicePixelRatio,e=window.innerHeight*window.devicePixelRatio;y=Math.round(t*d.pixelRatio),v=Math.round(e*d.pixelRatio),u.setSize(y,v),l.setSize(y,v),S.setSize(t,e),m.setSize(t,e),f.resizeTarget(d.pixelRatio,o.backend.coordinateSystem===ee?v:0),c.set(1/y,1/v),k.uniforms.uTexelSize.value.copy(c),j.uniforms.uTexelSize.value.copy(c),J.uniforms.uTexelSize.value.copy(c),X.uniforms.uTexelSize.value.copy(c),Y.uniforms.uTexelSize.value.copy(c),W.uniforms.uTexelSize.value.copy(c),W.uniforms.uTextureSize.value.set(1/t,1/e),g.uniforms.uTextureSize.value.set(1/t,1/e),Ie(),g.uniforms.uImage.value.source?.data&&g.uniforms.uImageScale.value.copy(te(t,e,g.uniforms.uImage.value.width,g.uniforms.uImage.value.height))}function Ie(){const t=ze(o.backend.coordinateSystem===ee),e=t.uniforms;e.uImage.value=x,e.uTextureSize.value.set(1/m.width,1/m.height),e.uImageScale.value.copy(te(m.width,m.height,x.width,x.height)),w(t,S)}function te(t,e,s,i){const r=t/e,n=s/i,a=r>=n?r/n:1,p=r>=n?1:n/r;return new h(a,p)}function ae(t){const e=(t-Q)/1e3;if(f.isPointerDown){const i=k,r=i.uniforms,n=f.pointer.clone().sub(f.prevPointer).multiply(c).multiplyScalar(d.forceCoefficient);r.uData.value=u.texture,r.uForceCenter.value.copy(f.pointer.clone().multiply(c)),r.uForceDeltaV.value.copy(n),r.uForceRadius.value=d.forceRadius,w(i,l),z()}const s=Math.min(Math.max(Math.floor(e*240),1),8);for(let i=0;i<s;i++){const r=e/s;{const n=j,a=n.uniforms;a.uData.value=u.texture,a.uDeltaT.value=r,a.uDissipation.value=d.dissipation,w(n,l),z()}{const n=J,a=n.uniforms;a.uData.value=u.texture,w(n,l),z()}for(let n=0;n<d.solverIteration;n++){const a=X,p=a.uniforms;p.uData.value=u.texture,w(a,l),z()}{const n=Y,a=n.uniforms;a.uData.value=u.texture,w(n,l),z()}{const n=W,a=n.uniforms;a.uImage.value=S.texture,a.uData.value=u.texture,a.uDeltaT.value=r,w(n,m),[S,m]=[m,S]}}{const i=g,r=i.uniforms;r.uImage.value=S.texture,w(i,null)}f.updatePreviousPointer(),Q=t,requestAnimationFrame(ae)}function Z(t){o.setRenderTarget(t),o.clearColor(),o.setRenderTarget(null)}function w(t,e){I.material=t,o.setRenderTarget(e),o.render(D,U),o.setRenderTarget(null)}function z(){[u,l]=[l,u]}async function Fe(t){I.material=t;const e=await o.debug.getShaderAsync(D,U,I);console.log(e.vertexShader),console.log(e.fragmentShader)}
